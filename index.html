<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ReplyForge — Email Reply Generator</title>
  <meta name="description" content="Paste an email. Generate calm, professional replies instantly." />

  <style>
    /* ===== YOUR EXISTING STYLES (UNCHANGED) ===== */
    body {
      margin:0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #070A12;
      color: #EAF0FF;
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 20px; }
    textarea, .out {
      width:100%; min-height:180px;
      background:#0B1220; color:#EAF0FF;
      border:1px solid #1F2937; border-radius:12px;
      padding:12px; font-size:14px;
    }
    button {
      padding:10px 14px; border-radius:999px;
      border:none; cursor:pointer;
      background:#7C3AED; color:white;
    }
    .out { white-space: pre-wrap; margin-top:10px; }
  </style>
</head>

<body>
  <div class="wrap" id="app">
    <h1>ReplyForge</h1>
    <p>Paste → click → send (no fluff)</p>

    <textarea id="incoming" placeholder="Paste the email here..."></textarea>

    <div style="margin:10px 0">
      <select id="scenario">
        <option value="client-angry">Angry client</option>
        <option value="boss-urgent">Boss urgent</option>
        <option value="say-no">Say no</option>
        <option value="follow-up">Follow up</option>
        <option value="apology">Apology</option>
        <option value="professor">Professor</option>
      </select>

      <select id="tone">
        <option value="calm">Calm</option>
        <option value="warm">Warm</option>
        <option value="firm">Firm</option>
        <option value="short">Short</option>
        <option value="formal">Formal</option>
      </select>

      <input id="length" type="range" min="1" max="5" value="3" />
    </div>

    <button id="generateBtn">⚡ Generate</button>

    <div class="out" id="output">Your reply will appear here.</div>
  </div>

  <!-- ✅ SCRIPT LOADS AFTER DOM -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {

      const $ = (id) => document.querySelector(id);

      const API_URL = "https://replyforge-api.wcn6xdmynv.workers.dev";

      async function callAI(email) {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            email,
            scenario: $("#scenario").value,
            tone: $("#tone").value,
            length: Number($("#length").value)
          })
        });

        const data = await res.json();
        if (!res.ok) throw new Error("API error");
        return data.reply;
      }

      $("#generateBtn").addEventListener("click", async () => {
        const input = $("#incoming").value.trim();
        if (!input) return alert("Paste an email first.");

        $("#output").textContent = "Generating…";

        try {
          const reply = await callAI(input);
          $("#output").textContent = reply;
        } catch (e) {
          $("#output").textContent = "Error generating reply.";
        }
      });

    });
  </script>
</body>
</html>
